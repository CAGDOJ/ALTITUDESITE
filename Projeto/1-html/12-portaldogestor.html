<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Portal Institui√ß√£o Altitude</title>
  <link rel="stylesheet" href="/Projeto/2-css/12-portaldogestor.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="../4-java/supabase-init.js" defer></script>
  <script src="../4-java/12-portaldogestor.js" defer></script>



</head>
<body>
  <div class="container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <h1 class="logo">Institui√ß√£o Altitude</h1>
      <nav>
 
        <button onclick="abrirAba('dashboard')">Dashboard</button>
        <button onclick="abrirAba('relatorios')">Relat√≥rios</button>
        <button onclick="abrirAba('alunos')">Gest√£o de Alunos</button>
        <button onclick="abrirAba('cursos')">Gest√£o de Cursos</button>
        <button onclick="abrirAba('usuarios')">Gest√£o de Usu√°rios</button>
        <button onclick="abrirAba('chamados')">Chamados</button>
      </nav>
    </aside>

    <!-- Conte√∫do -->
    <main class="conteudo">
      <section id="dashboard" class="aba ativa">
  <h2>Dashboard de Indicadores</h2>

  <div class="cards">
    <!-- Indicadores j√° existentes -->
    <div class="card"> 
      <span class="icone">üë•</span>
      <h3 id="kpiTotalAlunos">--</h3>
      <p>Total de Alunos</p>
    </div>
    <div class="card"> 
      <span class="icone">üìö</span>
      <h3 id="kpiMatriculasAtivas">--</h3>
      <p>Matr√≠culas Ativas</p>
    </div>
    <div class="card"> 
      <span class="icone">üò¥</span>
      <h3 id="kpiUsuariosInativos">--</h3>
      <p>Usu√°rios Inativos</p>
    </div>
    <div class="card"> 
      <span class="icone">üí∞</span>
      <h3 id="kpiValoresPagos">R$ --</h3>
      <p>Valores Pagos</p>
    </div>

    <!-- üëá Novos cards -->
    <div class="card">
      <span class="icone">‚úÖ</span>
      <h3 id="kpiCertificados">--</h3>
      <p>Certificados Emitidos</p>
    </div>
    <div class="card">
      <span class="icone">üïí</span>
      <h3 id="kpiCertPendentes">--</h3>
      <p>Certificados Pendentes</p>
    </div>
    <div class="card">
      <span class="icone">üìà</span>
      <h3 id="kpiTaxaConclusao">--%</h3>
      <p>Taxa de Conclus√£o</p>
    </div>
    <div class="card qualidade">
  <span class="icone">‚≠ê</span>
  <h3>-- / 5</h3>
  <p>Qualidade M√©dia</p>
</div>

<div class="card chamados">
  <span class="icone">üì®</span>
  <h3>--</h3>
  <div class="detalhes-chamados"></div>
</div>


  <!-- Gr√°ficos -->
  <div class="graficos">
    <div class="grafico">
      <h3>Matr√≠culas por M√™s</h3>
      <canvas id="graficoMatriculas"></canvas>
    </div>
    <div class="grafico">
      <h3>Receita x Despesa</h3>
      <canvas id="graficoFinanceiro"></canvas>
    </div>
    <div class="grafico">
      <h3>Cursos Mais Procurados</h3>
      <canvas id="graficoCursos"></canvas>
    </div>
  </div>
</section>



<section id="relatorios" class="aba">
  <h2>üí∞ Relat√≥rios Financeiros</h2>

  <!-- Filtros / A√ß√µes -->
  <div class="toolbar">
    <label>Per√≠odo:
      <select id="filtroPeriodo">
        <option value="30">√öltimos 30 dias</option>
        <option value="90">√öltimos 90 dias</option>
        <option value="365">√öltimos 12 meses</option>
      </select>
    </label>
    <button id="btnExportar">Exportar CSV</button>
  </div>

  <!-- KPIs -->
  <div class="kpis">
    <div class="kpi"><span class="lbl">Saldo Financeiro</span><strong id="kSaldo">R$ 0,00</strong></div>
    <div class="kpi"><span class="lbl">Inadimpl√™ncia</span><strong id="kInad">0%</strong></div>
    <div class="kpi"><span class="lbl">Receita do m√™s</span><strong id="kReceitaMes">R$ 0,00</strong></div>
    <div class="kpi"><span class="lbl">Ticket m√©dio</span><strong id="kTicket">R$ 0,00</strong></div>
  </div>

  <!-- Gr√°ficos -->
  <div class="grid-2">
    <div class="card graf">
      <h3>Fluxo de Caixa</h3>
      <canvas id="chartFluxo" height="140"></canvas>
    </div>
    <div class="card graf">
      <h3>Receitas por Origem</h3>
      <canvas id="chartReceita" height="140"></canvas>
    </div>
  </div>

  <!-- Movimenta√ß√µes -->
  <div class="card">
    <h3>Movimenta√ß√µes</h3>
    <table class="tabela" id="tabMov">
      <thead>
        <tr><th>Data</th><th>Tipo</th><th>Descri√ß√£o</th><th>Valor (R$)</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

    <!-- Nova despesa -->
  <form class="inline" id="formDespesa">
    <input type="date" id="dtDespesa" required>
    <input type="text" id="descDespesa" placeholder="Descri√ß√£o" required>
    <input type="number" step="0.01" id="valorDespesa" placeholder="Valor (R$)" required>
    <button type="submit">Adicionar Despesa</button>
  </form>

  <!-- Nova receita -->
  <form class="inline" id="formReceita">
    <input type="date" id="dtReceita" required>
    <input type="text" id="descReceita" placeholder="Descri√ß√£o" required>
    <input type="number" step="0.01" id="valorReceita" placeholder="Valor (R$)" required>
    <select id="origemReceita" aria-label="Origem da receita">
      <option value="Mensalidades">Mensalidades</option>
      <option value="Matr√≠culas">Matr√≠culas</option>
      <option value="Material">Material</option>
      <option value="Outros">Outros</option>
    </select>
    <button type="submit">Adicionar Receita</button>
  </form>
</section>

</form>



<section id="alunos" class="aba">
  <h2>üë®‚Äçüéì Gest√£o de Alunos</h2>

  <div class="toolbar">
    <input id="alnBusca" type="search" placeholder="Buscar por nome ou RA‚Ä¶">
    <select id="alnStatus">
      <option value="TODOS">Todos</option>
      <option value="ATIVO">Ativo</option>
      <option value="INATIVO">Inativo</option>
    </select>
    <select id="alnOrdenar">
      <option value="ra-asc">RA (‚Üë)</option>
      <option value="ra-desc">RA (‚Üì)</option>
      <option value="nome-asc">Nome (A‚ÜíZ)</option>
      <option value="nome-desc">Nome (Z‚ÜíA)</option>
    </select>
    <button id="alnNovo">Adicionar aluno</button>
    <button id="alnExportar">Exportar CSV</button>
  </div>

  <div class="card">
    <table class="tabela" id="tabAlunos">
      <thead>
        <tr>
          <th style="width:110px">RA</th>
          <th>Nome</th>
          <th style="width:200px">E-mail</th>
          <th style="width:140px">Telefone</th>
          <th style="width:90px">Status</th>
          <th style="width:160px">A√ß√µes</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <div class="paginacao">
      <button id="pgPrev">‚óÄ</button>
      <span id="pgInfo">1 / 1</span>
      <button id="pgNext">‚ñ∂</button>
    </div>
  </div>
</section>

<!-- Modal Add/Editar -->
<div class="modal" id="modalAluno" aria-hidden="true">
  <div class="modal__sheet">
    <h3 id="modalTitulo">Novo aluno</h3>
    <form id="formAluno">
      <div class="grid2">
        <label>RA
          <input id="fRa" type="text" placeholder="gerado automaticamente" disabled>
        </label>
        <label>Status
          <select id="fStatus">
            <option value="ATIVO">Ativo</option>
            <option value="INATIVO">Inativo</option>
          </select>
        </label>
      </div>
      <label>Nome
        <input id="fNome" type="text" required>
      </label>
      <label>E-mail
        <input id="fEmail" type="email" required>
      </label>
      <label>Telefone
        <input id="fTel" type="text" placeholder="(00) 00000-0000">
      </label>
      <div class="actions">
        <button type="button" class="ghost" id="btnCancelar">Cancelar</button>
        <button type="submit" id="btnSalvarAluno">Salvar</button>
      </div>
    </form>
  </div>
</div>


      <section id="cursos" class="aba">
  <h2>üìö Gest√£o de Cursos</h2>
  <p class="sub">Cadastre cursos por √°rea, suba materiais (PDF, v√≠deo, √°udio, imagem) por m√≥dulo e crie avalia√ß√µes com 10 perguntas.</p>

  <!-- Filtros / a√ß√µes -->
  <div class="toolbar">
    <label>√Årea:
      <select id="curFiltroArea"></select>
    </label>
    <button id="btnNovaArea">+ Nova √°rea</button>
    <button id="btnNovoCurso">+ Novo curso</button>
    <button id="btnExportCursos">Exportar CSV</button>
  </div>

  <!-- Lista de cursos -->
  <div class="card">
    <table class="tabela" id="tabCursos">
      <thead>
        <tr>
          <th style="width:110px">C√≥digo</th>
          <th>Curso</th>
          <th style="width:180px">√Årea</th>
          <th style="width:100px">M√≥dulos</th>
          <th style="width:100px">Publicado</th>
          <th style="width:260px">A√ß√µes</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</section>

<!-- ========== MODAL: NOVA √ÅREA ========== -->
<div class="modal" id="modalArea" aria-hidden="true">
  <div class="modal__sheet">
    <h3>Nova √°rea</h3>
    <form id="formArea">
      <label>Nome da √°rea
        <input id="fAreaNome" type="text" required>
      </label>
      <div class="actions">
        <button type="button" class="ghost" id="fecharArea">Voltar</button>
        <button type="submit">Salvar</button>
      </div>
    </form>
  </div>
</div>

<!-- ========== MODAL: CURSO (dados gerais) ========== -->
<div class="modal" id="modalCurso" aria-hidden="true">
  <div class="modal__sheet">
    <h3 id="tituloCurso">Novo curso</h3>
    <form id="formCurso">
      <div class="grid2">
        <label>√Årea
          <select id="fCursoArea" required></select>
        </label>
        <label>Publicado
          <select id="fCursoPub">
            <option value="SIM">SIM</option>
            <option value="NAO" selected>NAO</option>
          </select>
        </label>
      </div>
      <label>Nome do curso
        <input id="fCursoNome" type="text" required>
      </label>
      <label>Carga hor√°ria (horas)
    <input id="fCursoHoras" type="number" min="1" max="2000" step="1" required>
    </label>
      <label>Descri√ß√£o breve
        <input id="fCursoDesc" type="text" maxlength="160" placeholder="At√© 160 caracteres">
      </label>
      <label>Foto de capa
        <input id="fCursoCapa" type="file" accept="image/*">
      </label>

      <div class="actions">
        <button type="button" class="ghost" id="fecharCurso">Voltar</button>
        <button type="submit" id="salvarCurso">Salvar</button>
      </div>
    </form>
  </div>
</div>

<!-- ========== MODAL: M√ìDULOS do curso ========== -->
<div class="modal" id="modalModulos" aria-hidden="true">
  <div class="modal__sheet">
    <h3>Gerenciar m√≥dulos ‚Äî <span id="mmCursoNome"></span></h3>

    <!-- Adicionar m√≥dulo -->
    <form id="formModulo" class="inline">
      <input id="fModuloTitulo" type="text" placeholder="T√≠tulo do m√≥dulo" required>
      <button type="submit">+ Adicionar m√≥dulo</button>
    </form>

    <!-- Lista de m√≥dulos -->
    <div class="card">
      <table class="tabela" id="tabModulos">
        <thead>
          <tr>
            <th style="width:50px">#</th>
            <th>T√≠tulo</th>
            <th style="width:120px">Materiais</th>
            <th style="width:120px">Quest√µes</th>
            <th style="width:300px">A√ß√µes</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <div class="actions">
      <button type="button" class="ghost" id="fecharModulos">Voltar</button>
    </div>
  </div>
</div>

<!-- ========== MODAL: MATERIAIS do m√≥dulo ========== -->
<div class="modal" id="modalMateriais" aria-hidden="true">
  <div class="modal__sheet">
    <h3>Materiais ‚Äî <span id="matModuloTitulo"></span></h3>

    <form id="formMaterial" class="grid3">
      <label>Tipo
        <select id="fMatTipo">
          <option value="PDF">PDF</option>
          <option value="VIDEO">V√≠deo (URL)</option>
          <option value="AUDIO">√Åudio</option>
          <option value="IMAGEM">Imagem</option>
        </select>
      </label>
      <label>Nome / T√≠tulo
        <input id="fMatNome" type="text" required>
      </label>
      <label id="wrapArquivo">Arquivo
        <input id="fMatArquivo" type="file" accept=".pdf,video/*,audio/*,image/*">
      </label>
      <label id="wrapUrl" class="hidden">URL do v√≠deo
        <input id="fMatUrl" type="url" placeholder="https://...">
      </label>
      <button type="submit">+ Adicionar material</button>
    </form>

    <div class="card">
      <table class="tabela" id="tabMateriais">
        <thead>
          <tr><th>Tipo</th><th>Nome</th><th>Origem</th><th style="width:120px">A√ß√µes</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    
    <div class="actions">
      <button type="button" class="ghost" id="fecharMateriais">Voltar</button>
    </div>
  </div>
</div>

<!-- ========== MODAL: AVALIA√á√ÉO (10 quest√µes) ========== -->
<div class="modal" id="modalQuestoes" aria-hidden="true">
  <div class="modal__sheet">
    <h3>Avalia√ß√£o ‚Äî <span id="qModuloTitulo"></span> <small>(m√°x. 10 perguntas)</small></h3>

    <form id="formQuestao" class="grid1">
      <label>Pergunta
        <input id="fPergunta" type="text" required>
      </label>
      <div class="grid2">
        <label>Alternativa A
          <input id="fA" type="text" required>
        </label>
        <label>Alternativa B
          <input id="fB" type="text" required>
        </label>
      </div>
      <div class="grid2">
        <label>Alternativa C
          <input id="fC" type="text" required>
        </label>
        <label>Alternativa D
          <input id="fD" type="text" required>
        </label>
      </div>
      <label>Correta
        <select id="fCorreta">
          <option value="A">A</option><option value="B">B</option>
          <option value="C">C</option><option value="D">D</option>
        </select>
      </label>
      <div class="actions">
        <button type="submit">+ Adicionar pergunta</button>
      </div>
    </form>

    <div class="card">
      <table class="tabela" id="tabQuestoes">
        <thead>
          <tr><th>#</th><th>Pergunta</th><th>Correta</th><th style="width:120px">A√ß√µes</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <div class="actions">
      <button type="button" class="ghost" id="fecharQuestoes">Voltar</button>
    </div>
  </div>
</div>
<section id="usuarios" class="aba">
  <h2>üë• Gest√£o de Usu√°rios</h2>
  <p class="sub">Criar/editar gestores, coordenadores, professores e colaboradores. Defina n√≠vel de acesso (1‚Äì4) e libere o portal.</p>

  <div class="toolbar">
    <input id="guBusca" type="search" placeholder="Buscar por nome ou e-mail‚Ä¶">
    <select id="guFiltroCargo" aria-label="Filtrar por cargo">
      <option value="TODOS">Todos</option>
      <option value="COLABORADOR">Colaborador</option>
      <option value="PROFESSOR">Professor</option>
      <option value="COORDENADOR">Coordenador</option>
      <option value="GESTOR">Gestor</option>
    </select>
    <select id="guFiltroStatus" aria-label="Filtrar por status">
      <option value="TODOS">Todos</option>
      <option value="ATIVO">Ativo</option>
      <option value="INATIVO">Inativo</option>
    </select>
    <button id="guNovo">+ Novo usu√°rio</button>
    <button id="guExport">Exportar CSV</button>
  </div>

  <div class="card">
    <table class="tabela" id="tabUsuarios">
      <thead>
        <tr>
          <th style="width:60px">ID</th>
          <th>Nome</th>
          <th style="width:230px">E-mail</th>
          <th style="width:140px">Cargo</th>
          <th style="width:80px">N√≠vel</th>
          <th style="width:90px">Status</th>
          <th style="width:260px">A√ß√µes</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</section>

<!-- MODAL: Usu√°rio -->
<div class="modal" id="modalUsuario" aria-hidden="true">
  <div class="modal__sheet">
    <h3 id="guTitulo">Novo usu√°rio</h3>
    <form id="formUsuario">
      <div class="grid2">
        <label>Nome
          <input id="guNome" type="text" required>
        </label>
        <label>E-mail
          <input id="guEmail" type="email" required>
        </label>
      </div>
      <div class="grid2">
        <label>Telefone
          <input id="guTel" type="text" placeholder="(00) 00000-0000">
        </label>
        <label>Status
          <select id="guStatus">
            <option value="ATIVO">Ativo</option>
            <option value="INATIVO">Inativo</option>
          </select>
        </label>
      </div>
      <div class="grid3">
        <label>Cargo
          <select id="guCargo" required>
            <option value="COLABORADOR">Colaborador</option>
            <option value="PROFESSOR">Professor</option>
            <option value="COORDENADOR">Coordenador</option>
            <option value="GESTOR">Gestor</option>
          </select>
        </label>
        <label>N√≠vel de acesso
          <select id="guNivel" required>
            <option value="1">1 ‚Äî Colaborador</option>
            <option value="2">2 ‚Äî Professor</option>
            <option value="3">3 ‚Äî Coordenador</option>
            <option value="4">4 ‚Äî Gestor</option>
          </select>
        </label>
        <label>UID (opcional)
          <input id="guId" type="text" placeholder="id do auth/sistema">
        </label>
      </div>

      <!-- Libera√ß√£o de portais -->
      <div class="card" style="margin-top:8px">
        <strong>Portais liberados</strong>
        <div class="grid3" style="margin-top:6px">
          <label><input type="checkbox" id="acColab"> Colaborador</label>
          <label><input type="checkbox" id="acProf"> Professor</label>
          <label><input type="checkbox" id="acCoord"> Coordenador</label>
        </div>
        <div style="margin-top:6px">
          <label><input type="checkbox" id="acGestor"> Gestor</label>
        </div>
      </div>

      <div class="card" style="margin-top:8px">
        <strong>Permiss√µes deste n√≠vel</strong>
        <ul id="guPermissoes" class="perm-list"></ul>
      </div>

      <div class="actions">
        <button type="button" class="ghost" id="guCancelar">Voltar</button>
        <button type="submit" id="guSalvar">Salvar</button>
      </div>
    </form>
  </div>
</div>

      

      <section id="chamados" class="aba">
  <h2>üì® Chamados</h2>

  <!-- KPIs -->
  <div class="kpis-ch">
    <div class="kpi-ch">
      <span class="label">Pendentes</span>
      <span class="value" id="chPendentes">0</span>
      <span class="muted">Abertos + Em andamento</span>
    </div>
    <div class="kpi-ch">
      <span class="label">Resolvidos</span>
      <span class="value" id="chResolvidos">0</span>
      <span class="muted">Per√≠odo filtrado</span>
    </div>
    <div class="kpi-ch alerta">
      <span class="label">Atrasados</span>
      <span class="value" id="chAtrasados">0</span>
      <span class="muted">Venceram o prazo</span>
    </div>
  </div>

  <!-- Filtros -->
  <div class="toolbar">
    <input id="chBusca" type="search" placeholder="Buscar por protocolo, aluno ou assunto‚Ä¶">
    <select id="chFiltroStatus" aria-label="Status">
      <option value="TODOS">Todos</option>
      <option value="ABERTO">Aberto</option>
      <option value="EM_ANDAMENTO">Em andamento</option>
      <option value="RESOLVIDO">Resolvido</option>
    </select>
    <select id="chFiltroPrioridade" aria-label="Prioridade">
      <option value="TODAS">Todas</option>
      <option value="URGENTE">Urgente</option>
      <option value="ALTA">Alta</option>
      <option value="MEDIA">M√©dia</option>
      <option value="BAIXA">Baixa</option>
    </select>
    <select id="chPeriodo" aria-label="Per√≠odo">
      <option value="7">√öltimos 7 dias</option>
      <option value="15" selected>√öltimos 15 dias</option>
      <option value="30">√öltimos 30 dias</option>
      <option value="90">√öltimos 90 dias</option>
      <option value="365">√öltimos 12 meses</option>
    </select>
  </div>

  <!-- Tabela -->
  <div class="card">
    <table class="tabela" id="tabChamados">
      <thead>
        <tr>
          <th style="width:120px">Protocolo</th>
          <th>Aluno</th>
          <th>Assunto</th>
          <th style="width:110px">Prioridade</th>
          <th style="width:100px">Criado</th>
          <th style="width:110px">Prazo</th>
          <th style="width:120px">Status</th>
          <th style="width:120px">SLA</th>
          <th style="width:160px">A√ß√µes</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</section>

<!-- MODAL: Chamado -->
<div class="modal" id="modalChamado" aria-hidden="true">
  <div class="modal__sheet modal-chamado">
    <h3 id="chModalTitulo">Chamado</h3>
    <div class="grid2">
      <div class="card">
        <div class="meta">
          <p><b>Protocolo:</b> <span id="chProto"></span></p>
          <p><b>Aluno:</b> <span id="chAluno"></span> ‚Äî <span id="chEmail"></span></p>
          <p><b>Assunto:</b> <span id="chAssunto"></span></p>
          <p><b>Categoria:</b> <span id="chCategoria"></span></p>
          <p><b>Prioridade:</b> <span id="chPrioridade" class="badge"></span></p>
          <p><b>Status:</b> <span id="chStatus" class="badge"></span></p>
          <p><b>Criado em:</b> <span id="chCriado"></span></p>
          <p><b>Prazo:</b> <span id="chPrazo"></span> <span id="chSLAChip" class="sla-chip"></span></p>
        </div>
        <div class="descricao" id="chDescricao"></div>
      </div>

      <div class="card">
        <strong>Hist√≥rico</strong>
        <div id="chHistorico" class="historico"></div>
        <form id="formResposta" class="mt8">
          <textarea id="chResposta" rows="4" placeholder="Escreva a resposta ao aluno‚Ä¶"></textarea>
          <div class="actions">
            <select id="chAcaoRapida">
              <option value="RESPONDER">Responder</option>
              <option value="RESP_E_ANDAMENTO">Responder e marcar Em andamento</option>
              <option value="RESP_RESOLVER">Responder e marcar Resolvido</option>
            </select>
            <button type="submit">Enviar</button>
            <button type="button" class="ghost" id="chFecharModal">Fechar</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>


  
</body>
</html>